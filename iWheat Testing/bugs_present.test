<?php
/**
As a developer, I want a regression test to prove that the fields and diseases pages of iWheat.org are not affected by a change.
*/

class BugsPresent extends FirstRemoteTestCase {
  public static function getInfo() {
    return array(
      'name' => 'BugsPresent',
      'description' => 'Tests the Bugs Present subpage of the Diagnostic Key',
      'group' => 'iWheat',
    );
  }

  function setUp()
  {
    parent::setUp(array('node'));
  }
  function testBugsPresent()
  {
    module_enable(array('contact'));
    $this->resetAll();

    $this->drupalGet('/pests');
    $this->Bugs_Present_Tab();
    $this->drupalGet('/pests/plantkey');
    $this->Plant_damage_only_tab();
  }
  function Bugs_Present_Tab()
  {
    //checks for army cutworm text
    $this->assertFieldByXPath('//tr[@class="odd views-row-first"]//td[@class="views-field views-field-title-1 active"]//a[@href="/pests/army-cutworm"]', "Army Cutworm", 'Army Cutwork found.');

    //Check that the army cutwork image exists
    $this->assertElementByXPath('//td[@class="views-field views-field-field-pest-image"]//a[@href="/pests/army-cutworm"]//img[@title="Army Cutworm Larvae"]', array(), 'Army Cutworm image found.');

    //checks for Armyworm text
    $this->assertFieldByXPath('//tr[@class="even"]//td[@class="views-field views-field-title-1 active"]//a[@href="/pests/armyworm"]', "Armyworm", 'Armyworm found.');

    //Check that the armyworm image exists
    $this->assertElementByXPath('//td[@class="views-field views-field-field-pest-image"]//a[@href="/pests/armyworm"]//img[@title="Armyworm"]', array(), 'Armyworm image found.');
  }
  function Plant_damage_only_tab()
  {
      //checks for the winter grain mite image
      $this->assertElementByXPath('//td[@class="views-field views-field-field-pest-image"]//a[@href="/pests/winter-grain-mite"]//img[@src="http://iwheat.org/sites/default/files/styles/medium/public/WinterGrainMite.jpeg?itok=0MnxfyyK"]', array(), 'Winter Grain Mite image found.');

      //checks for the winter grain mite damage image
      $this->assertElementByXPath('//td[@class="views-field views-field-field-pest-imgdmg1"]//a[@href="http://iwheat.org/sites/default/files/WinterGrainMiteDamage.jpg"]//img[@src="http://iwheat.org/sites/default/files/styles/medium/public/WinterGrainMiteDamage.jpg?itok=nsnKBV5E"]', array(), 'Winter Grain Mite Damage image found.');

      //checks for the white grub
      $this->assertElementByXPath('//td[@class="views-field views-field-field-pest-image"]//a[@href="/pests/white-grub"]//img[@src="http://iwheat.org/sites/default/files/styles/medium/public/white_grub_073.png?itok=goaOPrJ5"]', array(), 'White Grub image found.');

      //checks for the white grub damage
      $this->assertElementByXPath('//td[@class="views-field views-field-field-pest-imgdmg1"]//a[@href="http://iwheat.org/sites/default/files/wheat%20tillers%20damaged%20by%20white%20grub%20feeding.png"]//img[@src="http://iwheat.org/sites/default/files/styles/medium/public/wheat%20tillers%20damaged%20by%20white%20grub%20feeding.png?itok=a9nlNeEY"]', array(), 'White Grub Damage image found.');
  }
}

